(()=>{"use strict";class e{constructor(){}}class t{constructor(e){return e instanceof HTMLElement?(this.element=e,this):void 0!==e.target?(this.element=e.target,this):"string"==typeof e?(this.element=this.convertToElement(e),this):(this.element=this.convertToElement(this.getNameOfClass(e)),this)}convertToElement(e){if(e instanceof HTMLElement)return e;let t=document.createElement(e);return"Button"===e&&t.setAttribute("type","button"),t}getNameOfClass(e){let t=/function (.{1,})\(/.exec(e.constructor.toString());return t&&t.length>1?t[1]:""}getElement(){return this.element}}class n{constructor(e){this.deny=["Table","Td","Div","Thead","Tbody","Tfoot","Tr","Td","Th","Label","Span","I","A"],this.element=new t(e)}css(e,t=null){let n=this.element.getElement().style;switch(typeof e){case"object":for(const t in e)n[t]=e[t];break;case"string":if(null===t)return n[e];n[e]=t}return this}html(e=null){return null!=e?(this.removeChildNodes(),this.append(e),this):this.element.getElement().innerHTML}verifyElement(e,t="append"){if(this.element instanceof HTMLCollection)for(let t in this.element)void 0!==this.element[t].nodeType&&1==this.element[t].nodeType&&this.element[t].appendChild(e);else this.element.getElement().appendChild(e)}checkAppendValue(e){switch(typeof e){case"string":this.element.getElement().appendChild(document.createTextNode(e));break;case"number":this.element.getElement().appendChild(document.createTextNode(e.toString()));break;case"object":void 0!==e?this.verifyElement(e.getElement()):this.verifyElement(e)}}append(e){if(Array.isArray(e)||e instanceof HTMLCollection)for(let t in e)this.checkAppendValue(e[t]);else this.checkAppendValue(e);return this}removeChildNodes(){const e=this.element.getElement();if(e instanceof HTMLCollection)for(let t in e)this.removeChilds(e[t],e[t].childNodes);return this.removeChilds(e,e.childNodes),this}removeChilds(e,t){for(;e.firstChild;)e.removeChild(e.firstChild)}attr(e,t=!1){if("object"==typeof e&&0==t)for(let t in e)this.element.getElement().setAttribute(t,e[t]);else if("string"==typeof e&&0!=t)this.element.getElement().setAttribute(e,t);else if("string"==typeof e&&0==t)return this.element.getElement().getAttribute(e);return this}getText(e=!1){return e?(this.element.getElement().innerHTML=e,this):this.element.getElement().innerHTML}empty(){return this.removeChildNodes(),this}val(e=!1){return e||"string"==typeof e?(this.attr("value",e),this):this.attr("value")}class(e){return this.element.getElement().setAttribute("class",e),this}addClass(e){let t=this.element.getElement().getAttribute("class");return t+=" "+e,this.element.getElement().setAttribute("class",null!=t?t:""),this}text(e=!1){return e?(this.element.getElement().innerHTML=e,this):this.element.getElement().innerHTML}setInnerHtml(e){return this.element.getElement().innerHTML=e,this}getChilds(){let e=this.element.getElement().childNodes,t=[];for(let s in e)if(1==e[s].nodeType){let s=new n(e);t.push(s)}return t}remove(e=null){if(e instanceof Node)return this.element.getElement().removeChild(e),this;const t=this.element.getElement().parentElement;return t instanceof Node&&t.removeChild(this.element.getElement()),this}getSiblings(){let e=[];if(e.length>0){let t=new Array;for(let n of e)n.getElement()!=this.element.getElement()&&t.push(n);return t}return!1}getParent(){const e=this.element.getElement().parentElement;return console.log("parent",this.element.getElement().parentElement,e),e&&1==e.nodeType?new n(e):null}getElement(){return this.element.getElement()}}var s,r,i,l;!function(e){e.blue="blue",e.red="red",e.black="black",e.white="white",e.amber="#FFC300",e.indigo="indigo",e.cyan="cyan",e.rosadito="#FF8A80"}(s||(s={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.BEFORE=1]="BEFORE",e[e.AFTER=2]="AFTER"}(r||(r={}));class o{constructor(){this.eventsTree={beforeEvents:{},regularEvents:{}},this.setEventsByType=(e,t,n)=>{}}subscribe(e){var t;let n=this.eventsTree.regularEvents;e.type===r.BEFORE&&(n=this.eventsTree.beforeEvents);const s=e.channel;void 0===n[s]&&(n[s]=[]),null===(t=n[s])||void 0===t||t.push(e.action)}fire(e){const t=e.channel;if(void 0===this.eventsTree.regularEvents[t])throw Error(`Don't exist events attached to '${t}'`);let n=this.eventsTree.regularEvents[t];e.type===r.BEFORE&&(n=this.eventsTree.beforeEvents[t]),n&&(null==n?void 0:n.length)>0&&n.forEach((t=>t(e.data)))}}class a{constructor(e,t=new o){this.tag=e,this.eventManager=t}click(e){this.tag.getElement().addEventListener("click",e)}}class c{constructor(e){this.params=e}render(){var e;const t=new n("button"),s=new a(t);return t.append(this.params.child.render()),s.click(this.params.onPressed),t.class(null!==(e=this.params.css)&&void 0!==e?e:""),t}}class h{constructor(e){this.params=e}render(){const e=new n("div");return e.css({width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center"}),e.append(this.params.child.render()),e}}!function(e){e.VERTICAL="column",e.HORIZONTAL="row"}(i||(i={}));class d{constructor(e){this.params=e}render(){var e;const t=new n("div");return console.log("column 1",t.getParent()),t.css({width:"100%",height:"100%",display:"flex","flex-direction":null!==(e=this.params.direction)&&void 0!==e?e:i.VERTICAL}),t.append(this.params.children.map((e=>e.render()))),t}}class m{constructor(e){this.params=e}render(){var e,t;const s=new n("div"),r={};return(null===(e=this.params)||void 0===e?void 0:e.color)&&(r["background-color"]=this.params.color),(null===(t=this.params)||void 0===t?void 0:t.child)&&s.append(this.params.child.render()),s.css(r),s}}class u{constructor(e){this.params=e}render(){var e;const t=new n("div"),s=null!==(e=this.params.flex)&&void 0!==e?e:1;t.css({flex:`${s} auto`});const r=this.params.child.render();return r.css({width:"100%",height:"100%"}),t.append(r),t}}!function(e){e.VERTICAL="column",e.HORIZONTAL="row"}(l||(l={}));class p{constructor(e){this.params=e}setEvents(e,t,n=r.REGULAR){this.params.manager.subscribe({channel:this.params.stream,action:n=>{e.empty(),e.append(t(n).render())},type:n})}render(){var e,t;const n=new m({child:null!==(e=this.params.init)&&void 0!==e?e:new m}).render();n.css({width:"100%",height:"100%"});const s=null!==(t=this.params.inprogress)&&void 0!==t?t:void 0;return void 0!==s&&this.setEvents(n,s,r.BEFORE),this.params.manager.subscribe({channel:this.params.stream,action:e=>{const t=e.map(((e,t)=>this.params.builder(e,t).render()));n.empty(),n.append(t)}}),n}}class g{constructor(e){this.params=e}setEvents(e,t,n=r.REGULAR){this.params.manager.subscribe({channel:this.params.stream,action:s=>{console.log(`setting type: ${n}`,t,e),e.empty(),e.append(t(s).render())},type:n})}render(){var e,t;const n=new m({child:null!==(e=this.params.init)&&void 0!==e?e:new m}).render(),s=null!==(t=this.params.inprogress)&&void 0!==t?t:void 0;return void 0!==s&&this.setEvents(n,s,r.BEFORE),this.setEvents(n,this.params.builder),n}}class f{constructor(e,t){this.text=e,this.params=t}render(){const e=new n("span");return e.append(this.text),e}}class v extends o{constructor(){super()}}let E=class extends e{onConstruct(e){e.css({width:"300px",height:"600px"})}render(e){return new d({children:[new u({child:new m({color:s.indigo,child:new f("Row 1")}),flex:1}),new u({child:new m({color:s.red,child:new f("Row 2")}),flex:1}),new u({child:new m({color:s.cyan,child:new h({child:new c({css:"btn btn-success",child:new f("button"),onPressed:()=>{console.log("before click"),e.wtfButton()}})})}),flex:1}),new u({child:new m({color:s.blue,child:new g({stream:"characters",manager:e,inprogress:()=>new f("mientras execute!"),init:new f("Initial text"),builder:e=>(console.log("annnie",e),new f(`when data llega: ${e.length}`))})}),flex:2}),new u({child:new m({color:s.amber,child:new p({stream:"characters",manager:e,inprogress:()=>new f("list view inprogress !"),init:new h({child:new f("Initial text")}),builder:(e,t)=>new m({color:s.rosadito,child:new f(`ls data llega: ${e.name}`)})})}),flex:3})]})}};var w;E=function(e,t,n,s){var r,i=arguments.length,l=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}([(w={id:"square",stateManager:class extends v{constructor(){super()}wtfButton(){return e=this,t=void 0,s=function*(){console.log("1","inicianding"),this.fire({channel:"characters",data:{},type:r.BEFORE});const e=yield fetch("https://rickandmortyapi.com/api/character"),t=yield e.json();console.log("2",t),setTimeout((()=>this.fire({channel:"characters",data:t.results})),3e3)},new((n=void 0)||(n=Promise))((function(r,i){function l(e){try{a(s.next(e))}catch(e){i(e)}}function o(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}a((s=s.apply(e,t||[])).next())}));var e,t,n,s}}},function(e){const t=function(...t){const s=function(){return new e(...t)};s.prototype=e.prototype;const r=document.getElementById(w.id),i=new n(r);s.prototype.onConstruct(i);const l=new w.stateManager;return i.append(s.prototype.render(l).render()),new s};return t.prototype=e.prototype,t})],E),new class{constructor(e){this.params=e}start(){this.params.modules.forEach((e=>new e))}}({modules:[E]}).start()})();